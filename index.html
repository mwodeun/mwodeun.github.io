<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>MWODEUN 모든경매</title>
  <style>
    :root{
      --purple:#6a0dad;
      --bg:#f5f5f5;
      --card:#ffffff;
      --muted:#666;
      --border:#e6e6e6;
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, "Noto Sans KR", Arial, sans-serif;
      background:var(--bg);
      color:#111;
    }
    header{
      position:sticky;
      top:0;
      z-index:10;
      background:#fff;
      border-bottom:1px solid var(--border);
    }
    .wrap{
      max-width:1200px;
      margin:0 auto;
      padding:14px 16px;
    }
    .topbar{
      display:flex;
      gap:14px;
      align-items:center;
      justify-content:space-between;
      flex-wrap:wrap;
    }
    .brand{
      display:flex;
      align-items:center;
      gap:12px;
      min-width:240px;
    }
    .brand img{
      height:44px;
      width:auto;
      display:block;
    }
    .brand .title{
      font-weight:800;
      font-size:18px;
      line-height:1.1;
    }
    .brand .sub{
      font-size:12px;
      color:var(--muted);
      margin-top:3px;
    }

    .controls{
      display:flex;
      gap:10px;
      align-items:center;
      flex-wrap:wrap;
      justify-content:flex-end;
      flex:1;
      min-width:260px;
    }

    .chip{
      display:flex;
      align-items:center;
      gap:8px;
      padding:8px 10px;
      background:#fff;
      border:1px solid var(--border);
      border-radius:10px;
    }
    .chip label{
      font-size:12px;
      color:var(--muted);
      white-space:nowrap;
    }
    input[type="text"], input[type="number"], input[type="datetime-local"], select{
      padding:8px 10px;
      border:1px solid var(--border);
      border-radius:10px;
      outline:none;
      background:#fff;
    }
    input[type="text"]{min-width:180px}
    select{min-width:120px}

    .btn{
      cursor:pointer;
      border:none;
      border-radius:10px;
      padding:10px 14px;
      font-weight:700;
    }
    .btn.primary{background:var(--purple); color:#fff;}
    .btn.gray{background:#eee; color:#111;}
    .btn.danger{background:#d93025; color:#fff;}
    .btn.small{padding:7px 10px; border-radius:9px; font-size:12px}

    .categoryBar{
      margin-top:10px;
      padding:10px 0 0;
      display:flex;
      gap:10px;
      flex-wrap:wrap;
    }
    .catBtn{
      cursor:pointer;
      border:1px solid var(--border);
      background:#fff;
      padding:8px 12px;
      border-radius:999px;
      font-weight:700;
      font-size:13px;
    }
    .catBtn.active{
      border-color:var(--purple);
      color:var(--purple);
      box-shadow:0 0 0 3px rgba(106,13,173,.08);
    }

    main .wrap{padding:18px 16px 70px}
    h2{
      margin:24px 0 12px;
      font-size:20px;
    }
    .sectionHint{
      color:var(--muted);
      font-size:13px;
      margin-top:-6px;
      margin-bottom:14px;
    }

    .grid{
      display:flex;
      flex-wrap:wrap;
      gap:16px;
      justify-content:center;
    }
    .card{
      width:min(330px, 100%);
      background:var(--card);
      border:1px solid var(--border);
      border-radius:16px;
      box-shadow:0 8px 18px rgba(0,0,0,0.06);
      overflow:hidden;
      display:flex;
      flex-direction:column;
    }
    .card.closed{
      background:#e9e9e9;
      filter:grayscale(0.15);
    }
    .card .body{
      padding:14px 14px 12px;
    }
    .row{
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap:10px;
      flex-wrap:wrap;
    }
    .badge{
      font-size:12px;
      font-weight:800;
      padding:6px 10px;
      border-radius:999px;
      background:rgba(106,13,173,.1);
      color:var(--purple);
      border:1px solid rgba(106,13,173,.18);
      white-space:nowrap;
    }
    .badge.closed{
      background:rgba(0,0,0,.08);
      color:#222;
      border-color:rgba(0,0,0,.1);
    }
    .name{
      font-size:18px;
      font-weight:900;
      margin:8px 0 8px;
      word-break:keep-all;
    }
    .meta{
      font-size:13px;
      color:var(--muted);
      line-height:1.45;
    }
    .price{
      margin-top:10px;
      font-size:16px;
      font-weight:900;
    }
    .price span{color:var(--purple)}
    .divider{
      height:1px;
      background:var(--border);
      margin:12px 0;
    }
    .actions{
      display:flex;
      gap:8px;
      flex-wrap:wrap;
      align-items:center;
      justify-content:space-between;
    }

    .bidBox{
      margin-top:10px;
      padding:10px;
      border:1px dashed rgba(106,13,173,.35);
      border-radius:12px;
      background:rgba(106,13,173,.04);
    }
    .bidBox .row{justify-content:flex-start}
    .bidHelp{
      font-size:12px;
      color:var(--muted);
      margin-top:6px;
      line-height:1.35;
    }
    .smallText{font-size:12px; color:var(--muted)}
    .countdown{font-weight:800}
    .lastBidder{
      font-weight:800;
      color:#111;
    }

    /* Admin panel */
    .adminPanel{
      display:none;
      margin-top:12px;
      padding:14px;
      background:#fff;
      border:1px solid var(--border);
      border-radius:16px;
      box-shadow:0 10px 22px rgba(0,0,0,.06);
    }
    .adminGrid{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap:10px;
    }
    .adminGrid .full{grid-column:1 / -1}
    @media (max-width:720px){
      .adminGrid{grid-template-columns:1fr}
      input[type="text"]{min-width:140px}
      .brand{min-width:auto}
    }
  </style>
</head>

<body>
  <header>
    <div class="wrap">
      <div class="topbar">
        <div class="brand">
          <img src="logo.png" alt="MWODEUN 모든경매" onerror="this.style.display='none'">
          <div>
            <div class="title">MWODEUN 모든경매</div>
            <div class="sub">중고 물품 경매 플랫폼 (시작가+마감시간+자동연장)</div>
          </div>
        </div>

        <div class="controls">
          <div class="chip">
            <label>닉네임</label>
            <input id="nickname" type="text" placeholder="입찰 닉네임" />
          </div>

          <div class="chip">
            <label>자동 증가</label>
            <select id="incSelect">
              <option value="1000">+1,000원</option>
              <option value="5000">+5,000원</option>
              <option value="10000">+10,000원</option>
              <option value="50000">+50,000원</option>
            </select>
          </div>

          <button class="btn primary" id="adminToggleBtn" onclick="toggleAdmin()">관리자 상품추가</button>
          <button class="btn gray" onclick="resetToSample()" title="샘플데이터로 초기화">샘플초기화</button>
        </div>
      </div>

      <div class="categoryBar" id="categoryBar"></div>

      <div class="adminPanel" id="adminPanel">
        <div class="adminGrid">
          <div>
            <div class="smallText">상품명</div>
            <input id="a_title" type="text" placeholder="예) 캠핑 테이블" />
          </div>
          <div>
            <div class="smallText">카테고리</div>
            <select id="a_category">
              <option value="가전">가전</option>
              <option value="공구/장비">공구/장비</option>
              <option value="전자스크랩">전자스크랩</option>
              <option value="생활용품/레저용품">생활용품/레저용품</option>
              <option value="건설 잔여자재">건설 잔여자재</option>
            </select>
          </div>

          <div>
            <div class="smallText">시작가(원)</div>
            <input id="a_startPrice" type="number" min="0" placeholder="예) 15000" />
          </div>
          <div>
            <div class="smallText">마감시간</div>
            <input id="a_endTime" type="datetime-local" />
          </div>

          <div class="full" style="display:flex; gap:8px; flex-wrap:wrap; align-items:center; justify-content:flex-start; margin-top:6px;">
            <button class="btn primary" onclick="adminSave()">등록/수정 저장</button>
            <button class="btn gray" onclick="adminClear()">입력칸 비우기</button>
            <span class="smallText" id="adminModeText">현재: 새 상품 등록 모드</span>
          </div>
        </div>
      </div>

    </div>
  </header>

  <main>
    <div class="wrap">
      <h2>진행중 경매</h2>
      <div class="sectionHint">마감시간이 지나면 자동으로 “마감된 경매”로 이동합니다. (LocalStorage 저장됨)</div>
      <div class="grid" id="openGrid"></div>

      <h2 style="margin-top:42px;">마감된 경매</h2>
      <div class="sectionHint">마감된 상품은 입찰이 불가하며, 자동으로 아래로 이동됩니다.</div>
      <div class="grid" id="closedGrid"></div>
    </div>
  </main>

  <script>
    /***********************
     * 5) 실제 데이터 저장(LocalStorage)
     ***********************/
    const LS_KEY = "mwodeun_products_v1";
    const LS_FILTER = "mwodeun_filter_v1";

    function nowISO(){
      const d = new Date();
      return d.toISOString();
    }

    function toLocalInputValue(date){
      // datetime-local은 timezone 반영된 "YYYY-MM-DDTHH:MM"
      const pad = n => String(n).padStart(2,'0');
      const y = date.getFullYear();
      const m = pad(date.getMonth()+1);
      const day = pad(date.getDate());
      const h = pad(date.getHours());
      const min = pad(date.getMinutes());
      return `${y}-${m}-${day}T${h}:${min}`;
    }

    function formatMoney(n){
      const num = Number(n || 0);
      return num.toLocaleString("ko-KR");
    }

    function formatEndTime(iso){
      const d = new Date(iso);
      if (isNaN(d.getTime())) return "시간정보 없음";
      return `${d.getFullYear()}-${String(d.getMonth()+1).padStart(2,'0')}-${String(d.getDate()).padStart(2,'0')} ` +
             `${String(d.getHours()).padStart(2,'0')}:${String(d.getMinutes()).padStart(2,'0')}`;
    }

    function calcRemain(endIso){
      const end = new Date(endIso).getTime();
      const now = Date.now();
      const diff = end - now;
      if (isNaN(end)) return {closed:false, text:"시간정보 없음"};
      if (diff <= 0) return {closed:true, text:"마감"};
      const sec = Math.floor(diff/1000);
      const h = Math.floor(sec/3600);
      const m = Math.floor((sec%3600)/60);
      const s = sec%60;
      return {closed:false, text:`${h}시간 ${m}분 ${s}초`};
    }

    function loadProducts(){
      try{
        const raw = localStorage.getItem(LS_KEY);
        if(!raw) return null;
        const parsed = JSON.parse(raw);
        if(!Array.isArray(parsed)) return null;
        return parsed;
      }catch(e){
        return null;
      }
    }

    function saveProducts(){
      localStorage.setItem(LS_KEY, JSON.stringify(state.products));
    }

    function seedSample(){
      const base = new Date();
      const plusMin = (min)=> new Date(base.getTime() + min*60*1000);

      return [
        {
          id: cryptoRandomId(),
          title:"캠핑 테이블",
          category:"생활용품/레저용품",
          startPrice:15000,
          currentPrice:15000,
          endTime: plusMin(180).toISOString(),
          highestBidder:"",
          bidCount:0,
          createdAt: nowISO(),
          closed:false
        },
        {
          id: cryptoRandomId(),
          title:"임팩드릴(중고)",
          category:"공구/장비",
          startPrice:30000,
          currentPrice:30000,
          endTime: plusMin(90).toISOString(),
          highestBidder:"",
          bidCount:0,
          createdAt: nowISO(),
          closed:false
        },
        {
          id: cryptoRandomId(),
          title:"전자스크랩 박스 1kg",
          category:"전자스크랩",
          startPrice:8000,
          currentPrice:8000,
          endTime: plusMin(15).toISOString(),
          highestBidder:"",
          bidCount:0,
          createdAt: nowISO(),
          closed:false
        }
      ];
    }

    function cryptoRandomId(){
      // 브라우저 호환용 간단 ID
      return "p_" + Math.random().toString(16).slice(2) + "_" + Date.now().toString(16);
    }

    /***********************
     * 전역 상태
     ***********************/
    const state = {
      products: [],
      filterCategory: "전체",
      adminEditingId: null
    };

    function loadFilter(){
      const raw = localStorage.getItem(LS_FILTER);
      if(raw) state.filterCategory = raw;
    }

    function saveFilter(){
      localStorage.setItem(LS_FILTER, state.filterCategory);
    }

    /***********************
     * 1단계 – 마감되면 자동으로 마감카드로 이동
     ***********************/
    function syncClosedFlags(){
      const now = Date.now();
      state.products.forEach(p=>{
        const end = new Date(p.endTime).getTime();
        if(!isNaN(end) && end <= now) p.closed = true;
      });
    }

    /***********************
     * 카테고리 UI
     ***********************/
    const CATEGORIES = ["전체","가전","공구/장비","전자스크랩","생활용품/레저용품","건설 잔여자재"];

    function renderCategoryBar(){
      const bar = document.getElementById("categoryBar");
      bar.innerHTML = "";
      CATEGORIES.forEach(cat=>{
        const btn = document.createElement("button");
        btn.className = "catBtn" + (state.filterCategory===cat ? " active":"");
        btn.textContent = cat;
        btn.onclick = ()=>{
          state.filterCategory = cat;
          saveFilter();
          renderAll();
        };
        bar.appendChild(btn);
      });
    }

    function passFilter(p){
      if(state.filterCategory === "전체") return true;
      return p.category === state.filterCategory;
    }

    /***********************
     * 1) 입찰 금액 자동 증가 시스템
     * 2) 입찰자 닉네임 표시
     * 3) 보증금 확인 후 입찰 (체크해야 입찰됨)
     * + 마감 시 입찰 불가
     ***********************/
    function doBid(productId){
      const nick = (document.getElementById("nickname").value || "").trim();
      if(!nick){
        alert("닉네임을 먼저 입력해주세요.");
        document.getElementById("nickname").focus();
        return;
      }

      const p = state.products.find(x=>x.id===productId);
      if(!p) return;

      syncClosedFlags();
      if(p.closed){
        alert("이미 마감된 상품입니다.");
        renderAll();
        return;
      }

      // 보증금 체크 확인
      const chk = document.getElementById("dep_"+productId);
      if(!chk || !chk.checked){
        alert("입찰보증금(10,000원) 확인 체크 후 입찰할 수 있습니다.");
        return;
      }

      const inc = Number(document.getElementById("incSelect").value || 1000);
      const next = Number(p.currentPrice || p.startPrice || 0) + inc;

      // 자동연장(옵션): 마감 60초 이내 입찰 시 60초 연장
      const endMs = new Date(p.endTime).getTime();
      const now = Date.now();
      if(!isNaN(endMs)){
        const remainSec = Math.floor((endMs - now)/1000);
        if(remainSec > 0 && remainSec <= 60){
          p.endTime = new Date(now + 60*1000).toISOString();
        }
      }

      p.currentPrice = next;
      p.highestBidder = nick;
      p.bidCount = Number(p.bidCount || 0) + 1;

      saveProducts();
      renderAll();
    }

    /***********************
     * 4) 관리자 상품 추가 + 수정/삭제 버튼
     ***********************/
    function toggleAdmin(){
      const panel = document.getElementById("adminPanel");
      panel.style.display = (panel.style.display === "block") ? "none" : "block";
    }

    function adminClear(){
      state.adminEditingId = null;
      document.getElementById("a_title").value = "";
      document.getElementById("a_category").value = "가전";
      document.getElementById("a_startPrice").value = "";
      document.getElementById("a_endTime").value = "";
      document.getElementById("adminModeText").textContent = "현재: 새 상품 등록 모드";
    }

    function adminEdit(id){
      const p = state.products.find(x=>x.id===id);
      if(!p) return;

      state.adminEditingId = id;
      document.getElementById("adminPanel").style.display = "block";
      document.getElementById("a_title").value = p.title || "";
      document.getElementById("a_category").value = p.category || "가전";
      document.getElementById("a_startPrice").value = Number(p.startPrice || 0);
      document.getElementById("a_endTime").value = toLocalInputValue(new Date(p.endTime));
      document.getElementById("adminModeText").textContent = "현재: 수정 모드 (저장하면 해당 상품이 수정됩니다)";
      window.scrollTo({top:0, behavior:"smooth"});
    }

    function adminDelete(id){
      if(!confirm("정말 삭제하시겠습니까?")) return;
      state.products = state.products.filter(x=>x.id!==id);
      saveProducts();
      renderAll();
    }

    function adminSave(){
      const title = (document.getElementById("a_title").value || "").trim();
      const category = document.getElementById("a_category").value;
      const startPrice = Number(document.getElementById("a_startPrice").value || 0);
      const endLocal = document.getElementById("a_endTime").value; // "YYYY-MM-DDTHH:MM"

      if(!title){ alert("상품명을 입력하세요."); return; }
      if(!startPrice || startPrice < 0){ alert("시작가를 올바르게 입력하세요."); return; }
      if(!endLocal){ alert("마감시간을 선택하세요."); return; }

      const endIso = new Date(endLocal).toISOString();

      if(state.adminEditingId){
        const p = state.products.find(x=>x.id===state.adminEditingId);
        if(!p) return;

        p.title = title;
        p.category = category;
        p.startPrice = startPrice;

        // 현재가가 시작가보다 작으면 시작가로 보정
        if(Number(p.currentPrice || 0) < startPrice){
          p.currentPrice = startPrice;
        }
        p.endTime = endIso;

        // 수정 시 마감여부 다시 계산
        p.closed = false;
        syncClosedFlags();
      }else{
        const newP = {
          id: cryptoRandomId(),
          title,
          category,
          startPrice,
          currentPrice: startPrice,
          endTime: endIso,
          highestBidder:"",
          bidCount:0,
          createdAt: nowISO(),
          closed:false
        };
        state.products.unshift(newP);
        syncClosedFlags();
      }

      saveProducts();
      adminClear();
      renderAll();
    }

    /***********************
     * 렌더링
     ***********************/
    function renderCard(p){
      const remain = calcRemain(p.endTime);
      const closed = p.closed || remain.closed;

      const card = document.createElement("div");
      card.className = "card" + (closed ? " closed":"");

      const badge = document.createElement("div");
      badge.className = "badge" + (closed ? " closed":"");
      badge.textContent = closed ? "마감" : "진행중";

      const topRow = document.createElement("div");
      topRow.className = "row";
      topRow.appendChild(badge);

      const cat = document.createElement("div");
      cat.className = "smallText";
      cat.style.fontWeight = "900";
      cat.textContent = p.category || "-";
      topRow.appendChild(cat);

      const body = document.createElement("div");
      body.className = "body";

      const name = document.createElement("div");
      name.className = "name";
      name.textContent = p.title || "-";

      const meta = document.createElement("div");
      meta.className = "meta";
      const bidderText = p.highestBidder ? `<span class="lastBidder">${escapeHtml(p.highestBidder)}</span>` : "-";
      meta.innerHTML =
        `마감: <span class="countdown" id="cd_${p.id}">${closed ? "마감" : remain.text}</span><br>` +
        `마감시간: ${formatEndTime(p.endTime)}<br>` +
        `입찰자: ${bidderText} / 입찰횟수: <b id="bc_${p.id}">${Number(p.bidCount||0)}</b>회`;

      const price = document.createElement("div");
      price.className = "price";
      price.innerHTML = `현재가: <span id="cp_${p.id}">${formatMoney(p.currentPrice || p.startPrice)}</span>원`;

      const divider = document.createElement("div");
      divider.className = "divider";

      const actions = document.createElement("div");
      actions.className = "actions";

      // 입찰 버튼
      const bidBtn = document.createElement("button");
      bidBtn.className = "btn primary";
      bidBtn.textContent = closed ? "마감" : "입찰하기";
      bidBtn.disabled = closed;
      bidBtn.onclick = ()=>doBid(p.id);

      // 관리자 버튼들
      const adminArea = document.createElement("div");
      adminArea.style.display="flex";
      adminArea.style.gap="8px";

      const editBtn = document.createElement("button");
      editBtn.className = "btn gray small";
      editBtn.textContent = "수정";
      editBtn.onclick = ()=>adminEdit(p.id);

      const delBtn = document.createElement("button");
      delBtn.className = "btn danger small";
      delBtn.textContent = "삭제";
      delBtn.onclick = ()=>adminDelete(p.id);

      adminArea.appendChild(editBtn);
      adminArea.appendChild(delBtn);

      actions.appendChild(bidBtn);
      actions.appendChild(adminArea);

      // 입찰 박스(보증금 체크 + 다음 입찰가 표시)
      const bidBox = document.createElement("div");
      bidBox.className = "bidBox";
      const inc = Number(document.getElementById("incSelect").value || 1000);
      const next = Number(p.currentPrice || p.startPrice || 0) + inc;

      bidBox.innerHTML = `
        <div class="row" style="gap:10px; flex-wrap:wrap;">
          <label style="display:flex; align-items:center; gap:8px; font-weight:800; cursor:pointer;">
            <input type="checkbox" id="dep_${p.id}">
            입찰보증금(10,000원) 확인
          </label>
          <div class="smallText" style="font-weight:900;">
            다음 입찰가: <span id="nb_${p.id}">${formatMoney(next)}</span>원
          </div>
        </div>
        <div class="bidHelp">
          • 닉네임 입력 + 보증금 체크 후 “입찰하기” 누르면 자동으로 <b>선택한 금액만큼 증가</b>합니다.<br>
          • 마감 60초 이내 입찰 시 자동연장(60초) 적용.
        </div>
      `;

      if(closed){
        // 마감이면 체크 비활성화
        setTimeout(()=>{
          const chk = document.getElementById("dep_"+p.id);
          if(chk) chk.disabled = true;
        },0);
      }

      body.appendChild(topRow);
      body.appendChild(name);
      body.appendChild(meta);
      body.appendChild(price);
      body.appendChild(divider);
      body.appendChild(actions);
      body.appendChild(bidBox);

      card.appendChild(body);
      return card;
    }

    function renderAll(){
      syncClosedFlags();
      renderCategoryBar();

      const openGrid = document.getElementById("openGrid");
      const closedGrid = document.getElementById("closedGrid");
      openGrid.innerHTML = "";
      closedGrid.innerHTML = "";

      const filtered = state.products.filter(passFilter);

      const open = filtered.filter(p=>!p.closed);
      const closed = filtered.filter(p=>p.closed);

      if(open.length===0){
        openGrid.innerHTML = `<div class="smallText" style="padding:18px;">진행중 경매가 없습니다.</div>`;
      }else{
        open.forEach(p=> openGrid.appendChild(renderCard(p)));
      }

      if(closed.length===0){
        closedGrid.innerHTML = `<div class="smallText" style="padding:18px;">마감된 경매가 없습니다.</div>`;
      }else{
        closed
          .sort((a,b)=> new Date(b.endTime).getTime() - new Date(a.endTime).getTime())
          .forEach(p=> closedGrid.appendChild(renderCard(p)));
      }

      // “자동 증가” 선택이 바뀌면 각 카드의 “다음 입찰가” 갱신
      updateNextBidLabels();
    }

    function updateNextBidLabels(){
      const inc = Number(document.getElementById("incSelect").value || 1000);
      state.products.forEach(p=>{
        const el = document.getElementById("nb_"+p.id);
        if(!el) return;
        const next = Number(p.currentPrice || p.startPrice || 0) + inc;
        el.textContent = formatMoney(next);
      });
    }

    // 1단계: 1초마다 마감 체크 + 카운트다운 갱신 + 자동 이동(렌더 기반)
    function tick(){
      let changed = false;
      const now = Date.now();

      state.products.forEach(p=>{
        const end = new Date(p.endTime).getTime();
        const wasClosed = !!p.closed;
        if(!isNaN(end) && end <= now) p.closed = true;
        if(wasClosed !== p.closed) changed = true;

        const cd = document.getElementById("cd_"+p.id);
        if(cd){
          const remain = calcRemain(p.endTime);
          cd.textContent = (p.closed || remain.closed) ? "마감" : remain.text;
        }
      });

      if(changed){
        saveProducts();
        renderAll();
      }
    }

    function escapeHtml(str){
      return String(str)
        .replaceAll("&","&amp;")
        .replaceAll("<","&lt;")
        .replaceAll(">","&gt;")
        .replaceAll('"',"&quot;")
        .replaceAll("'","&#039;");
    }

    /***********************
     * 샘플 초기화
     ***********************/
    function resetToSample(){
      if(!confirm("샘플 데이터로 초기화할까요? (현재 저장된 상품/입찰정보가 사라집니다)")) return;
      localStorage.removeItem(LS_KEY);
      init();
    }

    /***********************
     * 초기화
     ***********************/
    function init(){
      loadFilter();

      const loaded = loadProducts();
      if(loaded && loaded.length){
        state.products = loaded;
      }else{
        state.products = seedSample();
        saveProducts();
      }

      syncClosedFlags();
      renderAll();

      document.getElementById("incSelect").addEventListener("change", ()=>{
        updateNextBidLabels();
      });
    }

    init();
    setInterval(tick, 1000);
  </script>
</body>
</html>
</html>
